<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Catcher Game</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }

        #game-container {
            position: relative;
            width: 300px;
            height: 400px;
            border: 2px solid #333;
            overflow: hidden;
            background-image: linear-gradient(to bottom, #e0f7fa, #80deea);
            border-radius: 10px;
        }

        .basket {
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 80px; /* Fixed width */
            height: 20px;
            background-color: #007BFF;
            border-radius: 10px;
            transform: translateX(-50%);
            transition: background-color 0.3s;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .ball {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            top: 0;
            transition: transform 0.2s;
        }

        #score, #coins, #shop {
            position: absolute;
            font-size: 20px;
            color: #333;
        }

        #score {
            top: 10px;
            left: 10px;
        }

        #coins {
            top: 40px;
            left: 10px;
        }

        #shop {
            top: 10px;
            right: 10px;
            cursor: pointer;
        }

        #shop-menu {
            display: none;
            position: absolute;
            top: 80px;
            right: 10px;
            background-color: white;
            border: 1px solid #333;
            border-radius: 5px;
            padding: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .upgrade {
            cursor: pointer;
            padding: 5px;
            background-color: lightgrey;
            border: 1px solid #333;
            border-radius: 5px;
            text-align: center;
            margin: 5px 0;
        }

        .caught {
            transform: scale(1.5);
            opacity: 0; /* Fade out */
        }

        #game-over {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            z-index: 10;
        }

        #restart-btn {
            margin-top: 10px;
            padding: 5px 10px;
            background-color: #28a745;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Color Catcher Game</h1>
    <div id="game-container">
        <div id="basket" class="basket"></div>
        <div id="ball" class="ball"></div>
    </div>
    <div id="score">Score: 0</div>
    <div id="coins">Coins: 0</div>
    <div id="shop">ðŸ›’ Shop</div>
    <div id="shop-menu">
        <div class="upgrade" id="upgrade-speed">Buy Speed Upgrade (10 Coins)</div>
        <div class="upgrade" id="upgrade-color">Buy Color Upgrade (15 Coins)</div>
        <div class="upgrade" id="upgrade-size">Buy Size Upgrade (20 Coins)</div>
    </div>

    <div id="game-over">
        <h2>imagine losing this game ðŸ’€</h2>
<h3> if the game is acting weird, refresh the site </h3>
        <p>score: <span id="final-score">0</span></p>
        <button id="restart-btn">Restart Game</button>
    </div>

    <script>
        const basket = document.getElementById('basket');
        const ball = document.getElementById('ball');
        const scoreDisplay = document.getElementById('score');
        const coinsDisplay = document.getElementById('coins');
        const speedUpgradeButton = document.getElementById('upgrade-speed');
        const colorUpgradeButton = document.getElementById('upgrade-color');
        const sizeUpgradeButton = document.getElementById('upgrade-size');
        const shopButton = document.getElementById('shop');
        const shopMenu = document.getElementById('shop-menu');
        const gameOverScreen = document.getElementById('game-over');
        const finalScoreDisplay = document.getElementById('final-score');
        const restartButton = document.getElementById('restart-btn');

        let score = 0;
        let coins = 0;
        let speed = 10; // Constant speed for falling balls
        let upgradeColor = false; // Whether the basket color upgrade has been purchased
        let basketSize = 80; // Fixed basket width
        let gameRunning = true; // Track if the game is running

        // Load saved data from localStorage
        function loadGameData() {
            const savedCoins = localStorage.getItem('coins');
            const savedUpgrades = localStorage.getItem('upgrades');
            const savedSize = localStorage.getItem('basketSize');

            if (savedCoins) coins = parseInt(savedCoins);
            if (savedUpgrades) upgradeColor = savedUpgrades === 'true';
            if (savedSize) basketSize = parseInt(savedSize);

            updateDisplays();
        }

        // Update score and coin displays
        function updateDisplays() {
            scoreDisplay.textContent = 'Score: ' + score;
            coinsDisplay.textContent = 'Coins: ' + coins;
            basket.style.backgroundColor = upgradeColor ? getRandomColor() : '#007BFF';
            basket.style.width = basketSize + 'px'; // Update basket size
        }

        function startGame() {
            resetBall();
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowLeft') {
                    moveBasket(-20);
                } else if (e.key === 'ArrowRight') {
                    moveBasket(20);
                }
            });

            let fallSpeed = setInterval(() => {
                if (!gameRunning) return; // Stop the game if not running

                let ballTop = parseInt(window.getComputedStyle(ball).top);
                if (ballTop >= 380) {
                    gameOver();
                    return;
                } else {
                    ball.style.top = ballTop + speed + 'px'; // Use constant speed
                }

                // Check if the ball is caught
                if (ballTop >= 360 && ballTop < 380) {
                    const basketLeft = parseInt(window.getComputedStyle(basket).left);
                    const basketWidth = parseInt(window.getComputedStyle(basket).width);
                    const ballLeft = parseInt(window.getComputedStyle(ball).left);
                    
                    if (ballLeft + 20 > basketLeft && ballLeft < basketLeft + basketWidth) {
                        score++;
                        coins++;
                        ball.classList.add('caught');
                        setTimeout(() => {
                            ball.classList.remove('caught');
                            updateDisplays();
                        }, 200); // Remove effect after 200ms
                        resetBall();
                    }
                }
            }, 100);
        }

        function moveBasket(delta) {
            let newLeft = parseInt(window.getComputedStyle(basket).left) + delta;
            // Keep the basket within bounds
            newLeft = Math.max(0, Math.min(newLeft, 300 - basketSize));
            basket.style.left = newLeft + 'px';
        }

        function resetBall() {
            ball.style.top = '0px';
            ball.style.left = Math.random() * (300 - 20) + 'px'; // Ensure it stays within bounds
            let newColor = getRandomColor();
            ball.style.backgroundColor = newColor;
        }

        function getRandomColor() {
            const colors = ['red', 'blue', 'green', 'yellow', 'orange', 'purple'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        // Game Over Logic
        function gameOver() {
            gameRunning = false;
            finalScoreDisplay.textContent = score; // Show final score
            gameOverScreen.style.display = 'block';
        }

        // Restart the game
        restartButton.addEventListener('click', () => {
            score = 0; // Reset score
            speed = 5; // Reset speed to constant value
            upgradeColor = false; // Reset color upgrade
            basketSize = 40; // Reset basket size
            gameRunning = true;
            gameOverScreen.style.display = 'none'; // Hide game over screen
            updateDisplays(); // Update displays
            startGame(); // Restart game
        });

        // Upgrade functionality
        speedUpgradeButton.addEventListener('click', () => {
            if (coins >= 10) {
                coins -= 10;
                speed += 0; // No speed increase
                updateDisplays();
                saveGameData();
            } else {
                alert('Not enough coins for speed upgrade!');
            }
        });

        colorUpgradeButton.addEventListener('click', () => {
            if (coins >= 15) {
                coins -= 15;
                upgradeColor = true; // Enable color upgrade
                updateDisplays();
                saveGameData();
            } else {
                alert('Not enough coins for color upgrade!');
            }
        });

        sizeUpgradeButton.addEventListener('click', () => {
            if (coins >= 20) {
                coins -= 20;
                basketSize += 20; // Increase basket size
                updateDisplays();
                saveGameData();
            } else {
                alert('Not enough coins for size upgrade!');
            }
        });

        // Toggle shop menu visibility
        shopButton.addEventListener('click', () => {
            shopMenu.style.display = shopMenu.style.display === 'none' || shopMenu.style.display === '' ? 'block' : 'none';
        });

        // Save data to localStorage
        function saveGameData() {
            localStorage.setItem('coins', coins);
            localStorage.setItem('upgrades', upgradeColor);
            localStorage.setItem('basketSize', basketSize);
        }

        loadGameData(); // Load game data on startup
        startGame();
    </script>
</body>
</html>
